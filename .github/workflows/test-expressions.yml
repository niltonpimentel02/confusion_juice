name: 'Test Expressions and Arithmetic'

on:
  workflow_dispatch:

env:
  ISSUE_STALE_DAYS: '45'
  ISSUE_CLOSE_DAYS: '60'
  PR_STALE_DAYS: '30'
  PR_CLOSE_DAYS: '45'

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: Show env as strings
        run: |
          echo "ISSUE_STALE_DAYS=${ISSUE_STALE_DAYS}"
          echo "ISSUE_CLOSE_DAYS=${ISSUE_CLOSE_DAYS}"
          echo "PR_STALE_DAYS=${PR_STALE_DAYS}"
          echo "PR_CLOSE_DAYS=${PR_CLOSE_DAYS}"

      - name: Compute differences using expressions
        run: |
          echo "Issue additional days (close - stale): ${{ fromJSON(env.ISSUE_CLOSE_DAYS) - fromJSON(env.ISSUE_STALE_DAYS) }}"
          echo "PR additional days (close - stale): ${{ fromJSON(env.PR_CLOSE_DAYS) - fromJSON(env.PR_STALE_DAYS) }}"

      - name: Use expressions to set step outputs (deprecated syntax but fine for demo)
        id: calc
        run: |
          echo "issue_additional_days=${{ fromJSON(env.ISSUE_CLOSE_DAYS) - fromJSON(env.ISSUE_STALE_DAYS) }}" >> "$GITHUB_OUTPUT"
          echo "pr_additional_days=${{ fromJSON(env.PR_CLOSE_DAYS) - fromJSON(env.PR_STALE_DAYS) }}" >> "$GITHUB_OUTPUT"

      - name: Read back outputs
        run: |
          echo "Issue additional days output: ${{ steps.calc.outputs.issue_additional_days }}"
          echo "PR additional days output: ${{ steps.calc.outputs.pr_additional_days }}"

      - name: Interpolate arithmetic inside multiline string (simulated)
        run: |
          cat << 'EOF'
          Mensagem de teste:
          - Issue marca como stale ap贸s ${{ env.ISSUE_STALE_DAYS }} dias.
          - Fecha ap贸s ${{ env.ISSUE_CLOSE_DAYS }} dias.
          - Dias adicionais: ${{ fromJSON(env.ISSUE_CLOSE_DAYS) - fromJSON(env.ISSUE_STALE_DAYS) }}.
          - PR marca como stale ap贸s ${{ env.PR_STALE_DAYS }} dias.
          - Fecha ap贸s ${{ env.PR_CLOSE_DAYS }} dias.
          - Dias adicionais: ${{ fromJSON(env.PR_CLOSE_DAYS) - fromJSON(env.PR_STALE_DAYS) }}.
          EOF
